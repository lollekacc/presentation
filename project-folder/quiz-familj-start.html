<!-- Familj Quiz Partial -->
<section class="w-full bg-white text-gray-900">
  <main id="quizF-container" class="max-w-5xl mx-auto py-16 px-6 text-center">
    <h2 id="quizF-question" class="text-3xl font-semibold mb-6 text-gray-800">Laddar fr친ga...</h2>
    <div id="quizF-answers" class="flex flex-col gap-6 items-center"></div>
    <button id="quizF-restart" class="hidden mt-8 bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition">
      Starta om
    </button>
  </main>
</section>

<script>
(() => {
  const steps = [
    { id: 1, text: "Hur m친nga ska dela p친 abonnemanget?", answers: ["2", "3", "4", "5", "6"] },
    { id: 2, text: "Vad 칛r viktigast f칬r er i abonnemanget?", answers: ["T칛ckning", "Hastighet", "Fritext / Annat"] },
    { id: 3, text: "Ska ni flytta hit nummer eller skaffa nytt?", answers: ["Flytta hit nummer", "Skaffa nytt nummer"] },
  ];

  let currentStep = 0;
  const q = id => document.getElementById("quizF-" + id);
  const questionEl = q("question");
  const answersEl = q("answers");
  const restartBtn = q("restart");

  function renderStep() {
    const step = steps[currentStep];
    questionEl.textContent = step.text;
    answersEl.innerHTML = "";

    step.answers.forEach(ans => {
      const btn = document.createElement("button");
      btn.textContent = ans;
      btn.className = "bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition";
      btn.onclick = () => {
        if (step.id === 3) ans === "Flytta hit nummer" ? showMoveNumberInput() : showNewNumberOptions();
        else {
          currentStep++;
          renderStep();
        }
      };
      answersEl.appendChild(btn);
    });

    restartBtn.classList.toggle("hidden", currentStep === 0);
  }

  function showMoveNumberInput() {
    questionEl.textContent = "Ange ert nuvarande telefonnummer";
    answersEl.innerHTML = `
      <input id="quizF-number" type="tel" placeholder="0701234567 eller +46701234567"
        class="border border-gray-300 rounded-lg px-4 py-3 w-64 text-center focus:ring-2 focus:ring-blue-400 outline-none" />
      <button id="quizF-confirm" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition mt-4">
        Bekr칛fta nummer
      </button>
      <p id="quizF-error" class="text-red-600 text-sm mt-2"></p>
    `;

    document.getElementById("quizF-confirm").onclick = () => {
      const num = document.getElementById("quizF-number").value.trim();
      const err = document.getElementById("quizF-error");
      const pattern = /^(07\d{8}|\+467\d{8})$/;
      if (!pattern.test(num)) {
        err.textContent = "Numret m친ste vara 10 siffror och b칬rja med 07 eller +46 f칬ljt av 9 siffror.";
        return;
      }
      err.textContent = "";
      showOffersPerPerson();
    };
  }

  function showNewNumberOptions() {
    questionEl.textContent = "V칛lj ett nytt nummer";
    answersEl.innerHTML = `
      <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
        <button class="bg-gray-100 hover:bg-blue-100 border border-gray-300 px-6 py-3 rounded-lg transition">0701234567</button>
        <button class="bg-gray-100 hover:bg-blue-100 border border-gray-300 px-6 py-3 rounded-lg transition">0769876543</button>
        <button class="bg-gray-100 hover:bg-blue-100 border border-gray-300 px-6 py-3 rounded-lg transition">0725551122</button>
      </div>
      <p class="mb-3 text-gray-600">Eller s칬k efter ledigt nummer:</p>
      <input id="quizF-search" type="text" placeholder="S칬k ledigt nummer..."
        class="border border-gray-300 rounded-lg px-4 py-3 w-64 text-center focus:ring-2 focus:ring-blue-400 outline-none" />
      <button id="quizF-searchBtn" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition mt-4">
        S칬k
      </button>
      <p id="quizF-msg" class="text-green-600 text-sm mt-2"></p>
    `;

    [...answersEl.querySelectorAll("button.bg-gray-100")].forEach(btn => btn.onclick = showOffersPerPerson);

    document.getElementById("quizF-searchBtn").onclick = () => {
      const term = document.getElementById("quizF-search").value.trim();
      const msg = document.getElementById("quizF-msg");
      const pattern = /^(07\d{8}|\+467\d{8})$/;
      if (!pattern.test(term)) {
        msg.classList.replace("text-green-600", "text-red-600");
        msg.textContent = "Ange ett giltigt svenskt nummer (07XXXXXXXX eller +467XXXXXXXX).";
        return;
      }
      msg.classList.replace("text-red-600", "text-green-600");
      msg.textContent = `Numret ${term} 칛r ledigt 游꿀`;
      setTimeout(showOffersPerPerson, 1000);
    };
  }

  function showOffersPerPerson() {
    questionEl.textContent = "Erbjudanden med pris per person";
    answersEl.innerHTML = `
      <p class="text-lg mb-6 text-gray-700">H칛r visas familjeerbjudanden baserade p친 era val:</p>
      <a href="erbjudande.html" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition">Visa erbjudanden</a>
      <a href="signera.html" class="block mt-6 text-blue-600 font-semibold hover:underline">Forts칛tt till signering</a>
    `;
  }

  q("restart").addEventListener("click", () => {
    currentStep = 0;
    renderStep();
  });

  renderStep();
})();
</script>
